<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Previous head content remains the same -->
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Registered Instructors</h1>
    </div>

    <div class="filter-section">
      <div class="filter-group">
        <input 
          type="text" 
          id="nameFilter" 
          class="filter-input" 
          placeholder="Filter by Name"
        >
        <select id="courseFilter" class="filter-input">
          <option value="">All Courses</option>
          <option value="BSA">BSA</option>
          <option value="BSAIS">BSAIS</option>
          <option value="MSMarketing">MS Marketing</option>
          <option value="BSE">BSE</option>
          <option value="BSPublicAdministration">BS Public Administration</option>
        </select>
        <select id="yearFilter" class="filter-input">
          <option value="">All Years</option>
          <option value="1st">1st Year</option>
          <option value="2nd">2nd Year</option>
          <option value="3rd">3rd Year</option>
          <option value="4th">4th Year</option>
        </select>
      </div>
    </div>

    <div class="table-container">
      <table id="instructorTable" class="instructor-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Total Enrollments</th>
            <th>Courses</th>
          </tr>
        </thead>
        <tbody id="instructorTableBody">
          <!-- Instructor data will be inserted here -->
        </tbody>
      </table>
      <div id="noInstructorsMessage" class="no-instructors">No Instructors Enrolled Yet</div>
    </div>

    <div class="navigation-buttons">
      <a href="index.html" class="btn">Back to Schedule</a>
      <a href="Instructor.html" class="btn">Enroll New Instructor</a>
    </div>
  </div>

  <script>
    const tableBody = document.getElementById('instructorTableBody');
    const noInstructorsMessage = document.getElementById('noInstructorsMessage');
    const nameFilter = document.getElementById('nameFilter');
    const courseFilter = document.getElementById('courseFilter');
    const yearFilter = document.getElementById('yearFilter');

    function groupInstructorEnrollments(instructors) {
      const groupedInstructors = {};

      instructors.forEach(instructor => {
        if (!groupedInstructors[instructor.name]) {
          groupedInstructors[instructor.name] = {
            name: instructor.name,
            enrollments: [],
            courses: new Set(),
            totalEnrollments: 0
          };
        }

        groupedInstructors[instructor.name].enrollments.push(instructor);
        groupedInstructors[instructor.name].courses.add(instructor.course);
        groupedInstructors[instructor.name].totalEnrollments++;
      });

      return Object.values(groupedInstructors);
    }

    function loadAndDisplayInstructors() {
      // Retrieve instructors from localStorage
      const instructors = JSON.parse(localStorage.getItem('instructors')) || [];
      
      // Clear previous content
      tableBody.innerHTML = '';
      
      // If no instructors, show no instructors message
      if (instructors.length === 0) {
        noInstructorsMessage.style.display = 'block';
        return;
      }

      // Hide no instructors message
      noInstructorsMessage.style.display = 'none';

      // Group instructors
      const groupedInstructors = groupInstructorEnrollments(instructors);

      // Display grouped instructors
      groupedInstructors.forEach(instructor => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${instructor.name}</td>
          <td>${instructor.totalEnrollments}</td>
          <td>${Array.from(instructor.courses).join(', ')}</td>
        `;

        tableBody.appendChild(row);
      });
    }

    // Load instructors when page loads
    window.addEventListener('load', loadAndDisplayInstructors);

    // Listen for storage changes (useful for multiple tabs/windows)
    window.addEventListener('storage', loadAndDisplayInstructors);

    // Add event listeners for filters
    nameFilter.addEventListener('input', filterInstructors);
    courseFilter.addEventListener('change', filterInstructors);
    yearFilter.addEventListener('change', filterInstructors);

    function filterInstructors() {
      const instructors = JSON.parse(localStorage.getItem('instructors')) || [];
      const nameFilterValue = nameFilter.value.toLowerCase();
      const courseFilterValue = courseFilter.value;
      const yearFilterValue = yearFilter.value;

      const filteredInstructors = instructors.filter(instructor => 
        (nameFilterValue === '' || instructor.name.toLowerCase().includes(nameFilterValue)) &&
        (courseFilterValue === '' || instructor.course === courseFilterValue) &&
        (yearFilterValue === '' || instructor.year === yearFilterValue)
      );

      // Clear previous content
      tableBody.innerHTML = '';

      if (filteredInstructors.length === 0) {
        noInstructorsMessage.textContent = 'No Instructors Found';
        noInstructorsMessage.style.display = 'block';
        return;
      }

      // Hide no instructors message
      noInstructorsMessage.style.display = 'none';

      // Group and display filtered instructors
      const groupedInstructors = groupInstructorEnrollments(filteredInstructors);
      
      groupedInstructors.forEach(instructor => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${instructor.name}</td>
          <td>${instructor.totalEnrollments}</td>
          <td>${Array.from(instructor.courses).join(', ')}</td>
        `;

        tableBody.appendChild(row);
      });
    }
  </script>
</body>
</html>
