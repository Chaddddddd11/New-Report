<!DOCTYPE html>
<html>
<head>
  <title>DHVSU Scheduling</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #1A5F7A;
      --secondary: #2C8EBB;
      --accent: #F7B32D;
      --bg: #F4F7F6;
    }

    body {
      font-family: 'Roboto', sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 15px;
      background: var(--bg);
    }

    h2 {
      background: var(--primary);
      color: white;
      text-align: center;
      padding: 12px;
      border-radius: 4px;
    }

    select {
      margin: 8px 0;
      padding: 8px;
      width: 200px;
      border: 1px solid var(--secondary);
      border-radius: 4px;
      transition: border-color 0.2s;
    }

    select:focus {
      border-color: var(--accent);
      outline: none;
    }

    .disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    #selectionSummary {
      margin: 10px 0;
      padding: 8px;
      border: 1px solid var(--secondary);
      background: #f9f9f9;
      border-radius: 4px;
      display: flex;
      gap: 10px;
    }

    #scheduleTable {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    #scheduleTable th, #scheduleTable td {
      border: 1px solid #ddd;
      padding: 6px;
      text-align: center;
    }

    #scheduleTable th {
      background: var(--primary);
      color: white;
    }

    .nav-buttons {
      margin-top: 15px;
      display: flex;
      gap: 8px;
      justify-content: center;
    }

    .nav-buttons button {
      padding: 8px 12px;
      background: var(--secondary);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .nav-buttons button:hover {
      background: var(--accent);
    }

    label {
      margin-top: 8px;
      color: var(--primary);
      font-weight: 500;
    }

    .occupied-cell {
      background: var(--secondary);
      color: white;
    }

    .schedule-info {
      font-size: 11px;
    }

    .schedule-info .instructor { font-weight: bold; }
    .schedule-info .subject { font-style: italic; }
    .schedule-info .room { color: #f0f0f0; }
  </style>
</head>
<body>
  <h2>DHVSU Scheduling</h2>
  
  <label for="course">Course:</label>
  <select id="course">
    <option value="">-- Course --</option>
    <option value="BSA">BSA</option>
    <option value="BSAIS">BSAIS</option>
    <option value="MSMarketing">MS Marketing</option>
    <option value="BSE">BSE</option>
    <option value="BSPublicAdministration">BS Public Administration</option>
  </select>

  <label for="year">Year:</label>
  <select id="year" disabled>
    <option value="">-- Year --</option>
  </select>

  <label for="section">Section:</label>
  <select id="section" disabled>
    <option value="">-- Section --</option>
  </select>

  <div id="selectionSummary">
    <span id="courseSummary">----</span>
    <span>Capacity:</span>
    <span id="studentCapacityDisplay">---</span>
    <span>Students</span>
  </div>

  <h3>Schedule</h3>
  <table id="scheduleTable">
    <thead>
      <tr>
        <th>Time</th>
        <th>Mon</th>
        <th>Tue</th>
        <th>Wed</th>
        <th>Thu</th>
        <th>Fri</th>
        <th>Sat</th>
      </tr>
    </thead>
    <tbody id="scheduleBody"></tbody>
  </table>

  <div class="nav-buttons">
    <button onclick="navigateTo('Instructor.html')">Instructors</button>
    <button onclick="navigateTo('Room.html')">Rooms</button>
  </div>

  <script>
  // BSAIS Capacities
  'BSAIS-1A': 40, 'BSAIS-1B': 42, 'BSAIS-1C': 32, 'BSAIS-1D': 44, 'BSAIS-1E': 35,
  'BSAIS-2A': 41, 'BSAIS-2B': 40, 'BSAIS-2C': 50, 'BSAIS-2D': 44, 'BSAIS-2E': 44,
  'BSAIS-2F': 43, 'BSAIS-2G': 38,
  'BSAIS-3A': 42, 'BSAIS-3B': 50, 'BSAIS-3C': 41, 'BSAIS-3D': 47, 'BSAIS-3E': 41,
  'BSAIS-3F': 30,
  'BSAIS-4A': 36, 'BSAIS-4B': 35, 'BSAIS-4C': 45, 'BSAIS-4D': 42, 'BSAIS-4E': 30,
  'BSAIS-4F': 32, 'BSAIS-4G': 34,

  // MSMarketing Capacities
  'MSMarketing-1A': 36, 'MSMarketing-1B': 39, 'MSMarketing-1C': 35, 'MSMarketing-1D': 31,
  'MSMarketing-1E': 36, 'MSMarketing-1F': 43, 'MSMarketing-1G': 41, 'MSMarketing-1H': 41,
  'MSMarketing-2A': 35, 'MSMarketing-2B': 44, 'MSMarketing-2C': 49, 'MSMarketing-2D': 40,
  'MSMarketing-2E': 49, 'MSMarketing-2F': 50, 'MSMarketing-2G': 31, 'MSMarketing-2H': 46,
  'MSMarketing-2I': 36,
  'MSMarketing-3A': 42, 'MSMarketing-3B': 43, 'MSMarketing-3C': 36,
  'MSMarketing-4A': 37, 'MSMarketing-4B': 31, 'MSMarketing-4C': 49, 'MSMarketing-4D': 47,
  'MSMarketing-4E': 43, 'MSMarketing-4F': 44, 'MSMarketing-4G': 33, 'MSMarketing-4H': 45,
  'MSMarketing-4I': 31,

  // BSE Capacities
  'BSE-1A': 40, 'BSE-1B': 48, 'BSE-1C': 50,
  'BSE-2A': 42, 'BSE-2B': 34, 'BSE-2C': 44, 'BSE-2D': 40, 'BSE-2E': 36,
  'BSE-2F': 34, 'BSE-2G': 48, 'BSE-2H': 40,
  'BSE-3A': 39, 'BSE-3B': 32, 'BSE-3C': 44, 'BSE-3D': 50,
  'BSE-4A': 41, 'BSE-4B': 37, 'BSE-4C': 42, 'BSE-4D': 40, 'BSE-4E': 33,
  'BSE-4F': 43, 'BSE-4G': 49, 'BSE-4H': 38,

  // BSPublicAdministration Capacities
  'BSPublicAdministration-1A': 36, 'BSPublicAdministration-1B': 34,
  'BSPublicAdministration-1C': 50, 'BSPublicAdministration-1D': 31,
  'BSPublicAdministration-2A': 50, 'BSPublicAdministration-2B': 40,
  'BSPublicAdministration-2C': 43, 'BSPublicAdministration-2D': 36,
  'BSPublicAdministration-2E': 38, 'BSPublicAdministration-2F': 49,
  'BSPublicAdministration-2G': 36,
  'BSPublicAdministration-3A': 37, 'BSPublicAdministration-3B': 30,
  'BSPublicAdministration-3C': 33, 'BSPublicAdministration-3D': 38,
  'BSPublicAdministration-3E': 48,
  'BSPublicAdministration-4A': 34, 'BSPublicAdministration-4B': 43,
  'BSPublicAdministration-4C': 33, 'BSPublicAdministration-4D': 30,
  'BSPublicAdministration-4E': 43, 'BSPublicAdministration-4F': 39,
  'BSPublicAdministration-4G': 30
};

const courseConfig = {
  BSA: {
    years: ['1st', '2nd', '3rd', '4th'],
    sections: {
      '1st': ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'],
      '2nd': ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'],
      '3rd': ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'],
      '4th': ['A', 'B', 'C', 'D']
    }
  },
  BSAIS: {
    years: ['1st', '2nd', '3rd', '4th'],
    sections: {
      '1st': ['A', 'B', 'C', 'D', 'E'],
      '2nd': ['A', 'B', 'C', 'D', 'E', 'F', 'G'],
      '3rd': ['A', 'B', 'C', 'D', 'E', 'F'],
      '4th': ['A', 'B', 'C', 'D', 'E', 'F', 'G']
    }
  },
  MSMarketing: {
    years: ['1st', '2nd', '3rd', '4th'],
    sections: {
      '1st': ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'],
      '2nd': ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I'],
      '3rd': ['A', 'B', 'C'],
      '4th': ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I']
    }
  },
  BSE: {
    years: ['1st', '2nd', '3rd', '4th'],
    sections: {
      '1st': ['A', 'B', 'C'],
      '2nd': ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'],
      '3rd': ['A', 'B', 'C', 'D'],
      '4th': ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H']
    }
  },
  BSPublicAdministration: {
    years: ['1st', '2nd', '3rd', '4th'],
    sections: {
      '1st': ['A', 'B', 'C', 'D'],
      '2nd': ['A', 'B', 'C', 'D', 'E', 'F', 'G'],
      '3rd': ['A', 'B', 'C', 'D', 'E'],
      '4th': ['A', 'B', 'C', 'D', 'E', 'F', 'G']
    }
  }
};

// Initialize course select options
const yearSelect = document.getElementById('year');
const sectionSelect = document.getElementById('section');
const courseSummary = document.getElementById('courseSummary');
const studentCapacityDisplay = document.getElementById('studentCapacityDisplay');
const scheduleBody = document.getElementById('scheduleBody');

function navigateTo(page) {
  try {
    window.location.href = page;
  } catch (error) {
    console.error('Navigation error:', error);
    alert('Unable to navigate. Please check the page exists.');
  }
}

function generateTimeSlots() {
  return [
    '7:00-8:00', '8:00-9:00', '9:00-10:00', '10:00-11:00',
    '11:00-12:00', '12:00-13:00', '13:00-14:00', '14:00-15:00',
    '15:00-16:00', '16:00-17:00', '17:00-18:00', '18:00-19:00'
  ];
}

function autoFillSchedule() {
  const timeSlots = generateTimeSlots();
  const selectedCourse = courseSelect.value;
  const selectedYear = yearSelect.value;
  const selectedSection = sectionSelect.value;
  
  scheduleBody.innerHTML = '';

  const instructors = JSON.parse(localStorage.getItem('instructors')) || [];

  timeSlots.forEach(timeSlot => {
    const row = document.createElement('tr');
    const [startTime] = timeSlot.split('-');
    
    row.innerHTML = `<td>${timeSlot}</td>`;

    const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
    days.forEach(day => {
      const cell = document.createElement('td');

      if (selectedCourse && selectedYear && selectedSection) {
        const scheduledInstructor = instructors.find(instructor => {
          if (instructor.course !== selectedCourse ||
              instructor.year !== selectedYear ||
              instructor.section !== selectedSection ||
              instructor.day !== day) {
            return false;
          }

          const [instrStartTime] = instructor.time.split(' - ')[0].split(':');
          const [instrEndTime] = instructor.time.split(' - ')[1].split(':');
          const currentHour = startTime.split(':')[0];

          return parseInt(currentHour) >= parseInt(instrStartTime) &&
                 parseInt(currentHour) < parseInt(instrEndTime);
        });

        if (scheduledInstructor) {
          cell.className = 'occupied-cell';
          cell.innerHTML = `
            <div class="schedule-info">
              <div class="instructor">${scheduledInstructor.name}</div>
              <div class="subject">${scheduledInstructor.subject}</div>
              <div class="room">${scheduledInstructor.room || 'TBA'}</div>
            </div>
          `;
        }
      }

      row.appendChild(cell);
    });

    scheduleBody.appendChild(row);
  });
}

function updateSelectionSummary() {
  const course = courseSelect.value;
  const year = yearSelect.value;
  const section = sectionSelect.value;

  if (course && year && section) {
    const formattedYear = year === '1st' ? '1' : 
                         year === '2nd' ? '2' : 
                         year === '3rd' ? '3' : '4';
    const combinedKey = `${course}-${formattedYear}${section}`;
    
    const studentCapacity = studentCapacityMap[combinedKey] || '---';
    
    courseSummary.textContent = combinedKey;
    studentCapacityDisplay.textContent = studentCapacity;
  } else {
    courseSummary.textContent = '----';
    studentCapacityDisplay.textContent = '---';
  }

  autoFillSchedule();
}

// Course selection handler
courseSelect.addEventListener('change', function() {
  // Clear year and section selects
  yearSelect.innerHTML = '<option value="">-- Select Year --</option>';
  sectionSelect.innerHTML = '<option value="">-- Select Section --</option>';
  
  const selectedCourse = courseSelect.value;

  if (selectedCourse) {
    // Enable year select and populate with years
    yearSelect.disabled = false;
    const years = courseConfig[selectedCourse].years;
    years.forEach(year => {
      const option = document.createElement('option');
      option.value = year;
      option.textContent = year;
      yearSelect.appendChild(option);
    });
    
    // Reset section select and disable it
    sectionSelect.disabled = true;
  } else {
    // Disable both selects if no course is selected
    yearSelect.disabled = true;
    sectionSelect.disabled = true;
  }

  // Update summary and schedule
  updateSelectionSummary();
});

// Year selection handler
yearSelect.addEventListener('change', function() {
  // Clear section select
  sectionSelect.innerHTML = '<option value="">-- Select Section --</option>';
  
  const selectedCourse = courseSelect.value;
  const selectedYear = yearSelect.value;

  if (selectedCourse && selectedYear) {
    // Enable section select and populate with sections
    sectionSelect.disabled = false;
    const sections = courseConfig[selectedCourse].sections[selectedYear];
    sections.forEach(section => {
      const option = document.createElement('option');
      option.value = section;
      option.textContent = section;
      sectionSelect.appendChild(option);
    });
  } else {
    // Disable section select if no year is selected
    sectionSelect.disabled = true;
  }

  // Update summary and schedule
  updateSelectionSummary();
});

// Section selection handler
sectionSelect.addEventListener('focus', function() {
  if (!yearSelect.value) {
    alert('Please select a Year first');
    yearSelect.focus();
  }
});

sectionSelect.addEventListener('change', updateSelectionSummary);



// Section selection handler
sectionSelect.addEventListener('focus', function() {
  if (!yearSelect.value) {
    alert('Please select a Year first');
    courseSelect.focus();
  }
});

sectionSelect.addEventListener('change', updateSelectionSummary);

// Storage change handler
window.addEventListener('storage', function(e) {
  if (e.key === 'instructors') {
    autoFillSchedule();
  }
});

// Initialize schedule
document.addEventListener('DOMContentLoaded', function() {
  autoFillSchedule();
});

  </script>
</body>
</html>
