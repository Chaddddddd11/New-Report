<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Room Schedule Calendar</title>
  <style>
    :root {
      --primary-color: #d92323;
      --secondary-color: #ffcc00;
      --background-color: #f5f5f5;
      --text-color: #333;
      --cell-bg: #fff;
      --cell-border: #ddd;
    }

    body {
      font-family: Arial, sans-serif;
      background-color: var(--background-color);
      margin: 0;
      padding: 20px;
      color: var(--text-color);
    }

    h1 {
      text-align: center;
      color: var(--primary-color);
      margin-bottom: 30px;
    }

    .calendar {
      display: grid;
      grid-template-columns: 100px repeat(6, 1fr);
      border: 2px solid var(--primary-color);
      border-radius: 10px;
      overflow: hidden;
    }

    .calendar div {
      border: 1px solid var(--cell-border);
      padding: 10px;
      min-height: 60px;
      background-color: var(--cell-bg);
    }

    .header {
      background-color: var(--primary-color);
      color: white;
      font-weight: bold;
      text-align: center;
    }

    .time-label {
      font-weight: bold;
      background-color: #eee;
      text-align: center;
    }

    .room-entry {
      background-color: var(--secondary-color);
      color: #000;
      padding: 5px;
      border-radius: 5px;
      margin-top: 5px;
      font-size: 0.9em;
    }

    .actions {
      text-align: center;
      margin-top: 30px;
    }

    .actions button {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 10px 20px;
      margin: 5px;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .actions button:hover {
      background-color: #b31a1a;
    }

    .small-button {
      font-size: 0.7em;
      margin-left: 5px;
      background-color: white;
      color: var(--primary-color);
      border: 1px solid var(--primary-color);
    }

    .small-button:hover {
      background-color: #ffe0e0;
    }

    @media (max-width: 768px) {
      .calendar {
        grid-template-columns: 60px repeat(6, 1fr);
      }

      .calendar div {
        font-size: 0.8em;
        padding: 5px;
      }
    }
  </style>
</head>
<body>
  <h1>Room Availability Calendar</h1>
  <div class="calendar" id="calendarGrid"></div>

  <div class="actions">
    <button onclick="window.location.href='Room.html'">Register New Room</button>
    <button onclick="window.location.href='index.html'">Back to Home</button>
  </div>

  <script>
    const days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
    const timeSlots = [
      "7:00-8:00", "8:00-9:00", "9:00-10:00", "10:00-11:00",
      "11:00-12:00", "12:00-13:00", "13:00-14:00",
      "14:00-15:00", "15:00-16:00", "16:00-17:00", "17:00-18:00"
    ];

    const calendarGrid = document.getElementById("calendarGrid");

    // Header Row
    calendarGrid.innerHTML += `<div class="header">Time</div>`;
    days.forEach(day => {
      calendarGrid.innerHTML += `<div class="header">${day}</div>`;
    });

    // Create a map for easier lookup
    const roomData = JSON.parse(localStorage.getItem('rooms')) || [];

    // Create rows
    timeSlots.forEach(time => {
      calendarGrid.innerHTML += `<div class="time-label">${time}</div>`;

      days.forEach(day => {
        const matchedRooms = roomData.filter(r => r.day === day && r.time === time);
        let cellHTML = '';

        matchedRooms.forEach((room, index) => {
          const fullIndex = roomData.findIndex(r =>
            r.roomName === room.roomName && r.day === day && r.time === time
          );

          cellHTML += `
            <div class="room-entry">
              ${room.roomName} (${room.capacity})
              <button class="small-button" onclick="editRoom(${fullIndex})">Edit</button>
              <button class="small-button" onclick="deleteRoom(${fullIndex})">Delete</button>
            </div>
          `;
        });

        calendarGrid.innerHTML += `<div>${cellHTML}</div>`;
      });
    });

    function editRoom(index) {
      const room = JSON.parse(localStorage.getItem('rooms'))[index];
      const query = new URLSearchParams({
        edit: 'true',
        index,
        roomName: room.roomName,
        day: room.day,
        time: room.time,
        capacity: room.capacity
      }).toString();
      window.location.href = `Room.html?${query}`;
    }

    function deleteRoom(index) {
      if (confirm("Are you sure you want to delete this room?")) {
        let rooms = JSON.parse(localStorage.getItem('rooms')) || [];
        rooms.splice(index, 1);
        localStorage.setItem('rooms', JSON.stringify(rooms));
        location.reload();
      }
    }
  </script>
</body>
</html>
