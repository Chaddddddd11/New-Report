<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Room List</title>
  <style>
    :root {
      --primary-color: #d92323;
      --secondary-color: #ffcc00;
      --background-color: #f5f5f5;
      --text-color: #333;
    }
    body {
      font-family: 'Arial', sans-serif;
      background-color: var(--background-color);
      color: var(--text-color);
      padding: 20px;
    }
    header {
      text-align: center;
      margin-bottom: 20px;
    }
    header h1 {
      background-color: var(--primary-color);
      color: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .controls {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    .controls button {
      background-color: var(--secondary-color);
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1em;
    }
    .calendar {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 20px;
    }
    .day-column {
      background-color: white;
      border-radius: 10px;
      padding: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .day-column h2 {
      background-color: var(--primary-color);
      color: white;
      padding: 10px;
      border-radius: 5px;
      font-size: 1.1em;
      margin-bottom: 10px;
    }
    .room-card {
      background-color: #fff8f8;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 10px;
    }
    .room-card strong {
      color: var(--primary-color);
    }
    .room-card .actions {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
    }
    .room-card button {
      font-size: 0.8em;
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .edit-btn {
      background-color: var(--secondary-color);
    }
    .delete-btn {
      background-color: var(--primary-color);
      color: white;
    }
  </style>
</head>
<body>
  <header>
    <h1>Registered Rooms</h1>
  </header>
  <div class="controls">
    <button onclick="window.location.href='Room.html'">+ Register Room</button>
    <button onclick="window.location.href='index.html'">â¬… Back to Schedule</button>
  </div>
  <div class="calendar" id="roomList"></div>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbx1CA4hRI2k4ATlz77Vjgz2O3HxYdVvaKlwVZ2ilNkqWIij9MlrMEBD_6AdKbhrgOBi/exec";

    const days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
    const roomListContainer = document.getElementById("roomList");

    function fetchRooms() {
      fetch(scriptURL + "?action=read")
        .then(res => res.json())
        .then(data => renderRooms(data))
        .catch(err => console.error("Error fetching data:", err));
    }

    function renderRooms(rooms) {
      roomListContainer.innerHTML = "";
      days.forEach(day => {
        const column = document.createElement("div");
        column.className = "day-column";
        const title = document.createElement("h2");
        title.textContent = day;
        column.appendChild(title);

        const filtered = rooms.filter(r => r.day === day);
        filtered.forEach((room, index) => {
          const card = document.createElement("div");
          card.className = "room-card";
          card.innerHTML = `
            <div><strong>${room.roomName}</strong></div>
            <div>Time: ${room.time}</div>
            <div>Capacity: ${room.capacity}</div>
            <div class="actions">
              <button class="edit-btn" onclick="editRoom(${room.id})">Edit</button>
              <button class="delete-btn" onclick="deleteRoom(${room.id})">Delete</button>
            </div>
          `;
          column.appendChild(card);
        });

        roomListContainer.appendChild(column);
      });
    }

    function editRoom(id) {
      // Get current room data
      fetch(scriptURL + `?action=get&id=${id}`)
        .then(res => res.json())
        .then(room => {
          const query = new URLSearchParams({
            edit: "true",
            id: id,
            roomName: room.roomName,
            day: room.day,
            time: room.time,
            capacity: room.capacity
          });
          window.location.href = `Room.html?${query.toString()}`;
        });
    }

    function deleteRoom(id) {
      if (confirm("Are you sure you want to delete this room?")) {
        fetch(scriptURL + `?action=delete&id=${id}`)
          .then(() => fetchRooms());
      }
    }

    fetchRooms();
  </script>
</body>
</html>
